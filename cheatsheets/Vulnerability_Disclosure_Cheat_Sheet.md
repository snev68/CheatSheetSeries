# Vulnerability Disclosure Cheat Sheet

## Introduction

This cheat sheet is intended to provide guidance on the vulnerability disclosure process for both security researchers and organisations. This is an area where collaboration is extremely important, but that can often result in conflict between the two parties.

**Researchers should:**

- Ensure that any testing is legal and authorised.
- Make reasonable efforts to contact the security team of the organisation.
- Provide sufficient details to allow the vulnerabilities to be verified and reproduced.
- Request CVEs where appropriate.
- Not demand payment or rewards for reporting vulnerabilities outside of an established bug bounty program.

**Organisations should:**

- Provide a clear method for researchers to securely report vulnerabilities.
- Clearly establish the scope and terms of any bug bounty programs.
- Respond to reports in a reasonable timeline.
- Communicate openly with researchers.
- Not threaten legal action against researchers.
- Offer rewards and credit.

## Contents

There are a number of different models that can be be followed when disclosing vulnerabilities.

# Methods of Disclosure

## Private Disclosure

In the private disclosure model, the vulnerability is reported privately to the organisation. The organisation may choose to publish the details of the vulnerabilities, but this is done at the discretion of the organisation, not the researcher, meaning that many vulnerabilities may never be made public. The majority of bug bounty programs require that the researcher follows this model.

The main problem with this model is that if the vendor is unresponsive, or decides not to fix the vulnerability, then the details may never be made public. Historically this has lead to researchers getting fed up with companies ignoring and trying to hide vulnerabilities, leading them to the full disclosure approach.

## Full Disclosure

With the full disclosure approach, the full details of the vulnerability are made public as soon as they are identified. This avoids the problem of organisations ignoring vulnerabilities, however it also means that the full details (sometimes including exploit code) are available to attackers, often before a patch is available.

This makes the full disclosure approach very controversial, and it is seen as irresponsible by many people. Generally it should only be considered as a last resort, when all other methods have failed, or when exploit code is already publicly available.

## Responsible or Coordinated Disclosure

Responsible disclosure attempts to find a reasonable middle ground between these two approaches. With responsible disclosure, the initial report is made privately, but with the full details being published once a patch has been made available (sometimes with a delay to allow more time for the patches to be installed).

In many cases, the researcher also provides a deadline for the organisation to respond to the report, or to provide a patch. If this deadline is not met, then the researcher may adopt the full disclosure approach, and publish the full details.

Google's [Project Zero](https://googleprojectzero.blogspot.com/2020/01/policy-and-disclosure-2020-edition.html) adopts a similar approach, where the full details of the vulnerability are published after 90 days regardless of whether or not the organisation has published a patch.

## Reporting Vulnerabilities

This section is intended to provide guidance for security researchers on how to report vulnerabilities to organisations.

### Warnings and Legality

- Follow rules of bug bounty program if one exists
- Be aware of the laws in your country
- Demanding payment __may__ constitute blackmail
- Bug bounties are usually considered taxable income
  + Reporting and managing this is **your responsibility**
- Consider anonymous disclosure

### Finding Contact Details

The first step in reporting a vulnerability is finding the appropriate person to report it to. Although some organisations have clearly published disclosure policies, many do not, so it can be difficult to find the correct place to report the issue.

Where there is no clear disclosure policy, the following areas may provide contact details:

- Bug bounty programs such as [BugCrowd](https://bugcrowd.com/programs),  [HackerOne](https://hackerone.com/directory/programs) or [Open Bug Bounty](https://www.openbugbounty.org).
- A [security.txt](https://securitytxt.org) file on the website at `/security.txt` or `/.well-known/security.txt`.
- An existing issue tracking system.
- Generic email addresses such as `security@` or `abuse@`.
- The generic "Contact Us" page on the website.
- Social media platforms.
- Phoning the organisation.
- Reaching out to the community.

When reaching out to people who are not dedicated security contacts, request the details for a relevant member of staff, rather than disclosing the vulnerability details to whoever accepts the initial contact (especially over social media).

If it is not possible to contact the organisation directly, a national or sector-based  [CERT](https://en.wikipedia.org/wiki/Computer_emergency_response_team) may be able to assist.

### Initial Report

Once a security contact has been identified, an initial report should be made of the details of the vulnerability. Ideally this should be done over an encrypted channel (such as the use of PGP keys), although many organisations do not support this.

The initial report should include:

- Sufficient details of the vulnerability to allow it to be understood and reproduced.
- HTML snippets, screenshots or any other supporting evidence.
- Proof of concept code (if available).
- The impact of the vulnerability.
- Any references or further reading that may be appropriate.

In many cases, especially in smaller organisations, the security reports may be handled by developers or IT staff who do not have a security background. This means that they may not be familiar with many security concepts or terminology, so reports should be written in clear and simple terms.

It may also be beneficial to provide a recommendation on how the issue could be mitigated or resolved. However, unless the details of the system or application are known, or you are very confident in the recommendation then it may be better to point the developers to some more general guidance (such as an OWASP cheat sheet).

If you are planning to publish the details of the vulnerability after a period of time (as per some [responsible disclosure](#responsible-or-coordinated-disclosure) policies), then this should be clearly communicated in the initial email - but try to do so in a tone that doesn't sound threatening to the recipient.

If the organisation does not have an established bug bounty program, then avoid asking about payments or rewards in the initial contact - leave it until the issue has been acknowledged (or ideally fixed). In particular, **do not demand payment before revealing the details of the vulnerability**. At best this will look like an attempt to scam the company, at worst it may constitute blackmail.

### Ongoing Communication

- Maintain communication with vendor
- Provide further details if asked
- Retesting of suggested fixes
- Chase vendor and request updates when unresponsive

### When to Give Up

- Not all vendors are interested
  + Some are impossible to contact
  + Some don't care
  + Some are hostile and threaten legal action
- Known when to cut your losses and move on
- Don't get burned out over a specific issue
- Don't take it personally
- Don't risk your career and livelihood
- Focus your time and effort on companies who care
- Consider very carefully before going down the full disclosure route

### Publishing

- Discuss with vendor before publishing
- Consider rules of any bug bounty program and applicable laws
- May result in legal threats or action from hostile vendors

## Receiving Vulnerability Reports

This section is intended to provide guidance for organisations on how to accept and receive vulnerability reports

### Publishing Contact Details

- Make it easy for researchers to contact you
  + Contact us page
  + Common email addresses (security@)
  + Security.txt
  + Known vulnerability reporting/disclosure sites
- Provide PGP keys

### Bug Bounty Programs

- Provide financial rewards for researchers
- Must clearly define:
  + Scope
  + Types of vulnerabilities that are included
  + Reward levels
- Help mediate between researchers and organisations
- **Not a replacement for penetration testing or assurance activities**

### Communicating With Researchers

- Use PGP or other encrypted mechanisms
- Acknowledge initial receipt
- Provide updates to researcher
- Respond in a reasonable timeframe

#### Researchers Demanding Payment

- Some researchers will demand payment before revealing details
  + Usually a scam
  + Encourage use of a mediated platform for disclosure

### Triage

- Confirm whether vulnerability is real
- Obtain extra details where required
- Search for other instances of the vulnerability across the systems or codebase
- Identify the root cause of the vulnerability
- Consider outsourcing the initial triage to a third party (such as HackerOne)

### Fixing the Issue

- Implement and test fixes internally
- Request researcher confirms whether fix is effective
  + Share sufficient details with them

### Disclosure

#### Products and Open Source Software

- Request CVE if applicable
- Publish security advisory with details of affected versions
  + Credit the researcher
- Have a security-focused changelog on site
- Have a security-focused mailing list or announcements
- Publish sufficient details to help defenders

#### Private Systems

- Credit the researcher
